<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- MindAR -->
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: monospace;
    }

    #ui-overlay {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 85%;
      background: rgba(0,0,0,0.85);
      color: #00ffff;
      padding: 15px;
      border-radius: 15px;
      border: 2px solid #00ffff;
      text-align: center;
      display: none;
      z-index: 100;
    }

    #score {
      color: #00ff99;
      font-size: 18px;
    }

    button {
      margin-top: 8px;
      padding: 8px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      background: #ff00ff;
      color: white;
    }
  </style>
</head>

<body>

<!-- UI Overlay -->
<div id="ui-overlay">
  <p id="dialogue-text">Catch the glowing orb to know more about me üëÄ</p>
  <p id="score">Score: 0</p>
  <button onclick="resetGame()">Reset Game</button>
</div>

<a-scene
  mindar-image="imageTargetSrc: ./targets.mind;"
  vr-mode-ui="enabled: false"
  device-orientation-permission-ui="enabled: false"
>

  <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

  <!-- FRONT SIDE -->
  <a-entity mindar-image-target="targetIndex: 1">
    <a-text
      value="Flip the card to play üéÆ"
      align="center"
      color="#ff00ff"
      position="0 0 0.2"
      scale="0.8 0.8 0.8">
    </a-text>
  </a-entity>

  <!-- BACK SIDE -->
  <a-entity id="card-target" mindar-image-target="targetIndex: 0">

    <!-- Hologram Ring -->
    <a-ring
      radius-inner="0.14"
      radius-outer="0.17"
      color="#00ffff"
      position="0 0.3 0.3"
      animation="property: rotation;
                 to: 0 360 0;
                 loop: true;
                 dur: 2000">
    </a-ring>

    <!-- Game Orb -->
    <a-sphere
      id="game-orb"
      radius="0.09"
      color="#00ffff"
      position="0 0.3 0.3"
      animation="property: scale;
                 dir: alternate;
                 dur: 800;
                 to: 1.3 1.3 1.3;
                 loop: true"
      class="clickable">
    </a-sphere>

    <!-- Dynamic Name / Identity -->
    <a-text
      id="name-text"
      value="AYUSHI PADHY"
      align="center"
      color="#ffffff"
      position="0 -0.35 0.2"
      scale="0.7 0.7 0.7">
    </a-text>

  </a-entity>
</a-scene>

<script>
let score = 0;

const target = document.querySelector('#card-target');
const ui = document.querySelector('#ui-overlay');
const orb = document.querySelector('#game-orb');
const scoreText = document.querySelector('#score');
const dialogue = document.querySelector('#dialogue-text');
const nameText = document.querySelector('#name-text');

target.addEventListener("targetFound", () => {
  ui.style.display = "block";
});

target.addEventListener("targetLost", () => {
  ui.style.display = "none";
});

orb.addEventListener("click", () => {
  score++;
  scoreText.innerText = "Score: " + score;

  // vibration (mobile)
  if (navigator.vibrate) navigator.vibrate(80);

  // teleport orb
  const x = (Math.random() - 0.5).toFixed(2);
  const y = (Math.random() * 0.5 + 0.1).toFixed(2);
  orb.setAttribute("position", `${x} ${y} 0.3`);

  orb.setAttribute("color", score % 2 === 0 ? "#ff00ff" : "#00ff99");

  if (score === 2) {
    dialogue.innerText = "You found my curiosity üîç";
    nameText.setAttribute("value", "CREATIVE THINKER");
  }
  else if (score === 4) {
    dialogue.innerText = "Tech + Art = Me üöÄ";
    nameText.setAttribute("value", "AR | AI | DESIGN");
  }
  else if (score >= 6) {
    dialogue.innerText = "You unlocked my digital soul üëÅÔ∏è‚ú®";
    nameText.setAttribute("value", "FUTURE BUILDER");
  }
});

function resetGame() {
  score = 0;
  scoreText.innerText = "Score: 0";
  dialogue.innerText = "Catch the glowing orb to know more about me üëÄ";
  orb.setAttribute("color", "#00ffff");
  nameText.setAttribute("value", "AYUSHI PADHY");
}
</script>

</body>
</html>
